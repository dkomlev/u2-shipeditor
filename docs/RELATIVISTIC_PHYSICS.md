# Релятивистская физика в U2 FlightTest

## Обзор

Начиная с версии **v0.7.1 build 003**, симуляция использует корректную релятивистскую физику для расчёта движения кораблей на высоких скоростях.

## Основные концепции

### 1. Фактор Лоренца (γ)

```
γ = 1 / √(1 - β²)
```

где:
- `β = v/c` - отношение скорости корабля к скорости света
- `v` - текущая скорость корабля
- `c` - скорость света (задаётся в `AppConfig.physics.c_mps`)

### 2. Релятивистское увеличение массы

```
m_rel = γ × m₀
```

где:
- `m_rel` - релятивистская масса
- `m₀` - масса покоя корабля
- `γ` - фактор Лоренца

### 3. Релятивистское ускорение

```
a_rel = F / m_rel = (F / m₀) / γ = a_newtonian / γ
```

**Результат**: Чем ближе корабль к скорости света, тем меньше его ускорение при той же силе тяги.

## Практические эффекты

### Таблица зависимости ускорения от скорости

| Скорость (v/c) | β     | γ      | Ускорение (% от обычного) |
|----------------|-------|--------|---------------------------|
| 0.1c           | 0.1   | 1.005  | 99.5%                     |
| 0.3c           | 0.3   | 1.048  | 95.4%                     |
| 0.5c           | 0.5   | 1.155  | 86.6%                     |
| 0.7c           | 0.7   | 1.400  | 71.4%                     |
| 0.9c           | 0.9   | 2.294  | 43.6%                     |
| 0.95c          | 0.95  | 3.203  | 31.2%                     |
| 0.99c          | 0.99  | 7.089  | 14.1%                     |
| 0.999c         | 0.999 | 22.366 | 4.5%                      |

### График зависимости γ от β

```
γ
25 |                                    *
20 |                                  *
15 |                               *
10 |                           *
 5 |                      *
 4 |                   *
 3 |               *
 2 |          *
 1 |______*_________________________
   0   0.2  0.4  0.6  0.8  0.9  0.99  β (v/c)
```

## Игровые последствия

### Для игрока:

1. **На низких скоростях (< 0.5c)**: 
   - Эффект практически незаметен
   - Корабль управляется как обычно

2. **На средних скоростях (0.5c - 0.9c)**:
   - Заметное снижение ускорения
   - Требуется больше времени для маневров

3. **На высоких скоростях (> 0.9c)**:
   - Сильное снижение ускорения
   - Очень сложно изменить курс
   - Фактически невозможно достичь c

### Для баланса:

- **Скорость света - естественный предел**: Не нужны искусственные ограничения
- **Постепенное замедление**: Нет резкого "удара о стену" на высоких скоростях
- **Реалистичное поведение**: Соответствует реальной физике

## Реализация в коде

### core.js (строки 94-124)

```javascript
// Calculate current speed and β
const currentSpeed = Math.hypot(state.velocity.x, state.velocity.y);
const beta = currentSpeed / c;

// Calculate Lorentz factor γ
const beta2 = beta * beta;
const gamma = beta2 < 0.999 ? 1 / Math.sqrt(1 - beta2) : 22.366;

// Relativistic mass increase
const relativistic_mass_kg = gamma * mass_kg;

// Decompose acceleration into parallel/perpendicular components
// a_parallel = a_newtonian_parallel / γ^3
// a_perp     = a_newtonian_perp / γ

// Calculate new velocity
let vx = state.velocity.x + relWorldAx * dt;
let vy = state.velocity.y + relWorldAy * dt;
```

### Безопасный клэмп

На случай численных ошибок есть финальный клэмп на 0.999c:

```javascript
const newSpeed = Math.hypot(vx, vy);
if (newSpeed > c * 0.999) {
  const scale = (c * 0.999) / newSpeed;
  vx *= scale;
  vy *= scale;
}
```

Этот клэмп редко срабатывает при правильном релятивистском расчёте.

## Настройка скорости света

Скорость света задаётся в `AppConfig`:

```json
{
  "physics": {
    "c_mps": 100000
  }
}
```

По умолчанию: **100 000 м/с** (100 км/с для игрового баланса)

Реальная скорость света: **299 792 458 м/с** (слишком велика для игры)

### Почему именно 100 000 м/с?

При типичных параметрах истребителя:
- Тяга: 7776 kN
- Масса: 72 тонны
- Ускорение: 108 м/с²

Время достижения скоростей (без учёта релятивистских эффектов):
- **0.5c** (50 км/с): ~8 минут
- **0.9c** (90 км/с): ~14 минут  
- **0.99c** (99 км/с): ~15 минут

С учётом релятивистского увеличения массы, реальное время будет ещё больше.

Это обеспечивает:
- Игрок успевает почувствовать релятивистские эффекты
- Достижение околосветовых скоростей требует времени
- Скорость света остаётся недостижимым пределом

## Telemetry (HUD)

В HUD отображается:
- **γ (Gamma)**: Фактор Лоренца
- **v/c**: Отношение скорости к скорости света
- **SR active**: Индикатор активности релятивистских эффектов (v ≥ 0.5c)

Когда `v ≥ 0.5c`, HUD подсвечивает γ фиолетовым цветом, сигнализируя о релятивистских эффектах.

## Математическое обоснование

### Почему работает асимптотическое приближение к c?

Из релятивистской механики:

```
F = dp/dt = d(γm₀v)/dt
```

При постоянной силе и приближении к c:
- γ → ∞
- a = F/m_rel = F/(γm₀) → 0
- v → c (асимптотически)

График v(t) при постоянной силе:

```
v
c |________________________
  |                    ,-'
  |               ,-'
  |          ,-'
  |     ,-'
  | ,-'
  |'_________________________
    0                       t
```

## Ссылки

- [Специальная теория относительности (Wikipedia)](https://ru.wikipedia.org/wiki/Специальная_теория_относительности)
- [Релятивистская механика (Wikipedia)](https://ru.wikipedia.org/wiki/Релятивистская_механика)
- Einstein, A. (1905). "On the Electrodynamics of Moving Bodies"

---

**Версия документа**: v0.7.1 build 004  
**Дата**: 2025-11-12  
**Критическое изменение**: Скорость света увеличена с 1000 до 100000 м/с для реалистичных релятивистских эффектов
